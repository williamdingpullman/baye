<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Bayesian - 2 | Bayesian</title>
  <meta name="description" content="The webpages are mainly about Bayesian." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Bayesian - 2 | Bayesian" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The webpages are mainly about Bayesian." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Bayesian - 2 | Bayesian" />
  
  <meta name="twitter:description" content="The webpages are mainly about Bayesian." />
  

<meta name="author" content="Bill Last Updated:" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-1.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://williamdingpullman.github.io/" target="blank">Bill's Stats Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface: Motivation</a></li>
<li class="chapter" data-level="1" data-path="bayesian-1.html"><a href="bayesian-1.html"><i class="fa fa-check"></i><b>1</b> Bayesian - 1</a><ul>
<li class="chapter" data-level="1.1" data-path="bayesian-1.html"><a href="bayesian-1.html#frequentist-perspective"><i class="fa fa-check"></i><b>1.1</b> Frequentist perspective</a></li>
<li class="chapter" data-level="1.2" data-path="bayesian-1.html"><a href="bayesian-1.html#bayesian-perspective"><i class="fa fa-check"></i><b>1.2</b> Bayesian perspective</a></li>
<li class="chapter" data-level="1.3" data-path="bayesian-1.html"><a href="bayesian-1.html#continous-parameters"><i class="fa fa-check"></i><b>1.3</b> Continous parameters</a><ul>
<li class="chapter" data-level="1.3.1" data-path="bayesian-1.html"><a href="bayesian-1.html#uniform"><i class="fa fa-check"></i><b>1.3.1</b> Uniform</a></li>
<li class="chapter" data-level="1.3.2" data-path="bayesian-1.html"><a href="bayesian-1.html#uniform-prior-versus-posterior"><i class="fa fa-check"></i><b>1.3.2</b> Uniform: prior versus posterior</a></li>
<li class="chapter" data-level="1.3.3" data-path="bayesian-1.html"><a href="bayesian-1.html#uniform-equal-tailed-versus-hpd"><i class="fa fa-check"></i><b>1.3.3</b> Uniform: equal tailed versus HPD</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="bayesian-1.html"><a href="bayesian-1.html#bernoullibinomial-likelihood-with-uniform-prior"><i class="fa fa-check"></i><b>1.4</b> Bernoulli/binomial likelihood with uniform prior</a></li>
<li class="chapter" data-level="1.5" data-path="bayesian-1.html"><a href="bayesian-1.html#conjugate-priors"><i class="fa fa-check"></i><b>1.5</b> Conjugate priors</a></li>
<li class="chapter" data-level="1.6" data-path="bayesian-1.html"><a href="bayesian-1.html#poisson-distribution"><i class="fa fa-check"></i><b>1.6</b> Poisson distribution</a></li>
<li class="chapter" data-level="1.7" data-path="bayesian-1.html"><a href="bayesian-1.html#exponential-data"><i class="fa fa-check"></i><b>1.7</b> Exponential data</a></li>
<li class="chapter" data-level="1.8" data-path="bayesian-1.html"><a href="bayesian-1.html#normal-likelihood"><i class="fa fa-check"></i><b>1.8</b> Normal likelihood</a><ul>
<li class="chapter" data-level="1.8.1" data-path="bayesian-1.html"><a href="bayesian-1.html#when-variance-is-known"><i class="fa fa-check"></i><b>1.8.1</b> When variance is known</a></li>
<li class="chapter" data-level="1.8.2" data-path="bayesian-1.html"><a href="bayesian-1.html#when-variance-is-unknown"><i class="fa fa-check"></i><b>1.8.2</b> When variance is unknown</a></li>
</ul></li>
<li class="chapter" data-level="1.9" data-path="bayesian-1.html"><a href="bayesian-1.html#non-informative-priors"><i class="fa fa-check"></i><b>1.9</b> Non-informative priors</a><ul>
<li class="chapter" data-level="1.9.1" data-path="bayesian-1.html"><a href="bayesian-1.html#bernoulli"><i class="fa fa-check"></i><b>1.9.1</b> Bernoulli</a></li>
<li class="chapter" data-level="1.9.2" data-path="bayesian-1.html"><a href="bayesian-1.html#gaussian"><i class="fa fa-check"></i><b>1.9.2</b> Gaussian</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="bayesian-1.html"><a href="bayesian-1.html#jeffreys-priors"><i class="fa fa-check"></i><b>1.10</b> Jeffreys Priors</a><ul>
<li class="chapter" data-level="1.10.1" data-path="bayesian-1.html"><a href="bayesian-1.html#gaussian-1"><i class="fa fa-check"></i><b>1.10.1</b> Gaussian</a></li>
<li class="chapter" data-level="1.10.2" data-path="bayesian-1.html"><a href="bayesian-1.html#bernoulli-1"><i class="fa fa-check"></i><b>1.10.2</b> Bernoulli</a></li>
<li class="chapter" data-level="1.10.3" data-path="bayesian-1.html"><a href="bayesian-1.html#side-note-fisher-information"><i class="fa fa-check"></i><b>1.10.3</b> Side Note: Fisher Information</a></li>
<li class="chapter" data-level="1.10.4" data-path="bayesian-1.html"><a href="bayesian-1.html#prior-predictive-distribution"><i class="fa fa-check"></i><b>1.10.4</b> Prior predictive distribution</a></li>
</ul></li>
<li class="chapter" data-level="1.11" data-path="bayesian-1.html"><a href="bayesian-1.html#linear-regression"><i class="fa fa-check"></i><b>1.11</b> Linear regression</a><ul>
<li class="chapter" data-level="1.11.1" data-path="bayesian-1.html"><a href="bayesian-1.html#review"><i class="fa fa-check"></i><b>1.11.1</b> Review</a></li>
<li class="chapter" data-level="1.11.2" data-path="bayesian-1.html"><a href="bayesian-1.html#when-sigma2-is-known"><i class="fa fa-check"></i><b>1.11.2</b> When <span class="math inline">\(\sigma^2\)</span> is known</a></li>
<li class="chapter" data-level="1.11.3" data-path="bayesian-1.html"><a href="bayesian-1.html#when-sigma2-is-unknown"><i class="fa fa-check"></i><b>1.11.3</b> When <span class="math inline">\(\sigma^2\)</span> is unknown</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="bayesian-2.html"><a href="bayesian-2.html"><i class="fa fa-check"></i><b>2</b> Bayesian - 2</a><ul>
<li class="chapter" data-level="2.1" data-path="bayesian-2.html"><a href="bayesian-2.html#components-of-bayesian-models"><i class="fa fa-check"></i><b>2.1</b> Components of Bayesian models</a></li>
<li class="chapter" data-level="2.2" data-path="bayesian-2.html"><a href="bayesian-2.html#monte-carlo-estimation"><i class="fa fa-check"></i><b>2.2</b> Monte Carlo Estimation</a><ul>
<li class="chapter" data-level="2.2.1" data-path="bayesian-2.html"><a href="bayesian-2.html#mean-and-variance-application-of-central-limit-theorem"><i class="fa fa-check"></i><b>2.2.1</b> Mean and Variance: Application of Central Limit Theorem</a></li>
<li class="chapter" data-level="2.2.2" data-path="bayesian-2.html"><a href="bayesian-2.html#monte-carlo-error-standard-error"><i class="fa fa-check"></i><b>2.2.2</b> Monte Carlo error (Standard Error)</a></li>
<li class="chapter" data-level="2.2.3" data-path="bayesian-2.html"><a href="bayesian-2.html#expected-value-and-probability"><i class="fa fa-check"></i><b>2.2.3</b> Expected value and probability</a></li>
<li class="chapter" data-level="2.2.4" data-path="bayesian-2.html"><a href="bayesian-2.html#quantile"><i class="fa fa-check"></i><b>2.2.4</b> Quantile</a></li>
<li class="chapter" data-level="2.2.5" data-path="bayesian-2.html"><a href="bayesian-2.html#prior-predictive-distributions-marginalization"><i class="fa fa-check"></i><b>2.2.5</b> Prior predictive distributions (Marginalization)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="bayesian-2.html"><a href="bayesian-2.html#markov-chains"><i class="fa fa-check"></i><b>2.3</b> Markov chains</a><ul>
<li class="chapter" data-level="2.3.1" data-path="bayesian-2.html"><a href="bayesian-2.html#definition"><i class="fa fa-check"></i><b>2.3.1</b> Definition</a></li>
<li class="chapter" data-level="2.3.2" data-path="bayesian-2.html"><a href="bayesian-2.html#discrete-example"><i class="fa fa-check"></i><b>2.3.2</b> Discrete example</a></li>
<li class="chapter" data-level="2.3.3" data-path="bayesian-2.html"><a href="bayesian-2.html#continuous-example"><i class="fa fa-check"></i><b>2.3.3</b> Continuous example</a></li>
<li class="chapter" data-level="2.3.4" data-path="bayesian-2.html"><a href="bayesian-2.html#discrete-example-and-transition-matrix"><i class="fa fa-check"></i><b>2.3.4</b> Discrete example and transition matrix</a></li>
<li class="chapter" data-level="2.3.5" data-path="bayesian-2.html"><a href="bayesian-2.html#stationary-distribution"><i class="fa fa-check"></i><b>2.3.5</b> Stationary distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="bayesian-2.html"><a href="bayesian-2.html#metropolis-hastings"><i class="fa fa-check"></i><b>2.4</b> Metropolis-Hastings</a><ul>
<li class="chapter" data-level="2.4.1" data-path="bayesian-2.html"><a href="bayesian-2.html#procedure"><i class="fa fa-check"></i><b>2.4.1</b> Procedure</a></li>
<li class="chapter" data-level="2.4.2" data-path="bayesian-2.html"><a href="bayesian-2.html#demonstration"><i class="fa fa-check"></i><b>2.4.2</b> Demonstration</a></li>
<li class="chapter" data-level="2.4.3" data-path="bayesian-2.html"><a href="bayesian-2.html#r-code"><i class="fa fa-check"></i><b>2.4.3</b> R code</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="bayesian-2.html"><a href="bayesian-2.html#gibbs-sampling"><i class="fa fa-check"></i><b>2.5</b> Gibbs sampling</a><ul>
<li class="chapter" data-level="2.5.1" data-path="bayesian-2.html"><a href="bayesian-2.html#basic-idea"><i class="fa fa-check"></i><b>2.5.1</b> Basic idea</a></li>
<li class="chapter" data-level="2.5.2" data-path="bayesian-2.html"><a href="bayesian-2.html#procedure-1"><i class="fa fa-check"></i><b>2.5.2</b> Procedure</a></li>
<li class="chapter" data-level="2.5.3" data-path="bayesian-2.html"><a href="bayesian-2.html#example"><i class="fa fa-check"></i><b>2.5.3</b> Example</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.williamsding.com/" target="blank">Bill's website</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian---2" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Bayesian - 2</h1>
<div id="components-of-bayesian-models" class="section level2">
<h2><span class="header-section-number">2.1</span> Components of Bayesian models</h2>
<p><span class="math display">\[y_i=\mu+\epsilon_i\]</span></p>
<p>Where,</p>
<p><span class="math display">\[\epsilon_i \sim N(0, \sigma^2)\]</span></p>
<p><span class="math display">\[y_i \sim N(\mu, \sigma^2)\]</span>
(Thus, <span class="math inline">\(y_i\)</span> is <span class="math inline">\(=\)</span> to a fixed <span class="math inline">\(\mu\)</span> plus with a <span class="math inline">\(\epsilon_i\)</span>, whereas <span class="math inline">\(y_i \sim N(\mu, \sigma^2)\)</span>. These two expressions are not exactly the same, but they are connected.)</p>
<p><strong>Likelihood:</strong> <span class="math inline">\(P(y|\theta)\)</span> (<span class="math inline">\(P(y,\theta)=P(\theta)P(y|\theta)\)</span>)</p>
<p><strong>Prior:</strong> <span class="math inline">\(P(\theta)\)</span></p>
<p><strong>Posterior:</strong></p>
<p><span class="math display">\[P(\theta|y)=\frac{P(\theta, y)}{P(y)}=\frac{P(\theta, y)}{\int P(\theta, y)d\theta}=\frac{P(\theta)P(y|\theta)}{\int P(\theta, y)d\theta}=\frac{P(\theta)P(y|\theta)}{\int P(\theta)P(y|\theta)d\theta}\]</span>
<strong>Markts</strong></p>
<ol style="list-style-type: decimal">
<li><p>The only random variables in frequentist models are the data. In contrast, Bayesian paradigm also uses probability to describe one’s uncertainty about unknown model parameters.</p></li>
<li><p>Consider the following model for binary outcome <span class="math inline">\(y\)</span>:</p></li>
</ol>
<p><span class="math inline">\(y_i|\theta_i \sim Bern (\theta_i), i=1,2,3...6\)</span></p>
<p><span class="math inline">\(\theta_i |\alpha \sim Beta(a, b_0), i=1,2,3...6\)</span></p>
<p><span class="math inline">\(\alpha \sim Exp(r_0)\)</span></p>
<p>Thus, the joint distribution of all variable:</p>
<p><span class="math display">\[\prod_{i=1}^{6}[\theta_i^{y_i}(1-\theta_i)^{1-y_i}\frac{\Gamma(a+b_0)}{\Gamma(a)\Gamma(b_0)}\theta_i^{a-1}(1-\theta_i)^{b_0-1}]r_0e^{-r_0 \alpha}\]</span>
(Question: Why not write it as <span class="math inline">\(a_i\)</span>?)</p>
</div>
<div id="monte-carlo-estimation" class="section level2">
<h2><span class="header-section-number">2.2</span> Monte Carlo Estimation</h2>
<div id="mean-and-variance-application-of-central-limit-theorem" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Mean and Variance: Application of Central Limit Theorem</h3>
<p>If we simulate 100 samples from a Gamma(2,1), what is the approximate distribution of the sample average <span class="math inline">\(\bar{x^*}=\frac{1}{100} \sum_{i=1}^{100} x_i^*\)</span>?</p>
<p>As we know, based on the central limit theorem, the approximating distribution is normal with the mean equal to the sample mean, and the variance equal to the variance of the orignal variable divided by the sample size. We know that the mean for Gamma(2,1) is <span class="math inline">\(\frac{2}{1}=2\)</span> and variance is <span class="math inline">\(\frac{2}{1^2}=2\)</span>. Thus, we know that the mean for the distribution for <span class="math inline">\(\bar{x^*}\)</span> is 2, whereas the variance is <span class="math inline">\(\frac{2}{100}\)</span>. Thus, it is <span class="math inline">\(N(2,0.02)\)</span>.</p>
<p>Thus, we can get the generalized formula as follows:</p>
<p><span class="math display">\[\bar{\theta^*} \sim N(E(\theta), \frac{Var(\theta)}{m})\]</span>
Note that, it is the variance for <span class="math inline">\(\bar{\theta^*}\)</span>, not <span class="math inline">\(\theta\)</span>. The approximate for the variance for <span class="math inline">\(\theta\)</span> is <span class="math inline">\(\frac{1}{m}\sum(\theta_i^*-\bar{\theta^*})^2\)</span>.</p>
<p>The following R code is for the <span class="math inline">\(\theta\)</span>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">sample_data_gamma&lt;-<span class="kw">rgamma</span>(<span class="dv">10000</span>,<span class="dv">4</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">mean</span>(sample_data_gamma)</a></code></pre></div>
<pre><code>## [1] 2.0128</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">var</span>(sample_data_gamma)</a></code></pre></div>
<pre><code>## [1] 1.036456</code></pre>
<p>The following R code is for the <span class="math inline">\(\bar{\theta^*}\)</span>. As we can see, the variance is 0.0016, which is close to the true value of <span class="math inline">\(\frac{1}{1000}=0.001\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">mean_c&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb7-4" title="4">{mean_c[i]&lt;-<span class="kw">mean</span>(<span class="kw">rgamma</span>(<span class="dv">1000</span>,<span class="dv">4</span>,<span class="dv">2</span>))}</a>
<a class="sourceLine" id="cb7-5" title="5"><span class="kw">var</span>(mean_c)</a></code></pre></div>
<pre><code>## [1] 0.001634891</code></pre>
<p><strong>Side Note</strong></p>
<p>Note that the definition of variance is:</p>
<p><span class="math display">\[V(x)=E[(x-\mu)^2]\]</span></p>
<p>Thus, we can calculate the variance using integral:</p>
<p><span class="math display">\[V(x)=\int (x-\mu)^2 f(x)dx\]</span>
When we using samples from the simulation, we will get the following:</p>
<p><span class="math display">\[V(x)=\int (x-\mu)^2 f(x)dx= \frac{1}{m} \sum (x_i^*-\bar{x^*})^2\]</span>
Thus, we can use <span class="math inline">\(Var\)</span> function in <span class="math inline">\(R\)</span> with simulated sample to calculate the variance.</p>
</div>
<div id="monte-carlo-error-standard-error" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Monte Carlo error (Standard Error)</h3>
<p>For the <span class="math inline">\(\bar{x^*}\)</span>, we can use the CLT to approximate how accurate the Monte Carlo estimates are.</p>
<p><span class="math display">\[\frac{SD(sample)}{\sqrt{m}}\]</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">sample_data_gamma&lt;-<span class="kw">rgamma</span>(<span class="dv">10000</span>,<span class="dv">4</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-3" title="3"></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">hist</span>(sample_data_gamma, <span class="dt">freq=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb9-5" title="5"><span class="kw">curve</span>(<span class="kw">dgamma</span>(<span class="dt">x=</span>x, <span class="dt">shape=</span><span class="dv">4</span>, <span class="dt">rate=</span><span class="dv">2</span>), <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">var</span>(sample_data_gamma)</a></code></pre></div>
<pre><code>## [1] 0.9682145</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">sqrt</span>(<span class="kw">var</span>(sample_data_gamma))</a></code></pre></div>
<pre><code>## [1] 0.9839789</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">sd</span>(sample_data_gamma) </a></code></pre></div>
<pre><code>## [1] 0.9839789</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">sd</span>(sample_data_gamma) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">10000</span>)</a></code></pre></div>
<pre><code>## [1] 0.009839789</code></pre>
<p>We can also calculate Standard Error for the probablity</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">hist</span>(sample_data_gamma)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">se =<span class="st"> </span><span class="kw">sd</span>(sample_data_gamma<span class="op">&lt;</span><span class="dv">5</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb19-2" title="2">se</a></code></pre></div>
<pre><code>## [1] 0.0009547917</code></pre>
</div>
<div id="expected-value-and-probability" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Expected value and probability</h3>
<p>If you know that <span class="math inline">\(\theta \sim Beta(5,3)\)</span>, what is the approximate for the <span class="math inline">\(E(\frac{\theta}{1-\theta})\)</span>? You can use the following R code to calculate it.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">sample_data&lt;-<span class="kw">rbeta</span>(<span class="dv">1000</span>,<span class="dv">5</span>,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">mean</span>(sample_data<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>sample_data))</a></code></pre></div>
<pre><code>## [1] 2.789685</code></pre>
<p>If you want to calculate the approximate for the probability that <span class="math inline">\(\frac{\theta}{1-\theta}\)</span> is greater 1.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">mean</span>((sample_data<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>sample_data))<span class="op">&gt;</span><span class="dv">1</span>)</a></code></pre></div>
<pre><code>## [1] 0.789</code></pre>
</div>
<div id="quantile" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Quantile</h3>
<p>Use Monte Carlo to approximate the 0.3 quantile of N(0,1). Note that, the idea of quantile is to quantify the probability. Thus, the number we will get for 0.3 quantile if the value for the random variable’s cdf <span class="math inline">\(\int_{-\infty}^{quantile-number}dx\)</span>. As we can see below, <span class="math inline">\(quantile(sample_data2,0.3)\)</span> gets the result of -0.52, which is the same from the <span class="math inline">\(qnorm(0.3)\)</span>. Note that, the cdf of <span class="math inline">\(pnorm(-0.52)\)</span> will get the probablity of <span class="math inline">\(0.3\)</span>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">sample_data2&lt;-<span class="kw">rnorm</span>(<span class="dv">10000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">quantile</span>(sample_data2,<span class="fl">0.3</span>)</a></code></pre></div>
<pre><code>##        30% 
## -0.5260847</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">qnorm</span>(<span class="fl">0.3</span>)</a></code></pre></div>
<pre><code>## [1] -0.5244005</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">pnorm</span>(<span class="op">-</span><span class="fl">0.52</span>)</a></code></pre></div>
<pre><code>## [1] 0.3015318</code></pre>
</div>
<div id="prior-predictive-distributions-marginalization" class="section level3">
<h3><span class="header-section-number">2.2.5</span> Prior predictive distributions (Marginalization)</h3>
<p><span class="math display">\[y|\theta \sim Bin(10, \theta)\]</span>
<span class="math display">\[\theta \sim Beta(2,2)\]</span></p>
<p>Simulate:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(\theta^*\)</span> from beta</p></li>
<li><p>Given <span class="math inline">\(\theta\)</span>, draw <span class="math inline">\(y_i^* \sim Bin(10, \theta_i^*)\)</span></p></li>
<li><p>Get pairs (<span class="math inline">\(y_i^*\)</span>,<span class="math inline">\(\theta_i^*\)</span>)</p></li>
</ol>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">m=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb31-2" title="2"></a>
<a class="sourceLine" id="cb31-3" title="3">y=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb31-4" title="4">phi=<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb31-5" title="5"></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</a>
<a class="sourceLine" id="cb31-7" title="7">{</a>
<a class="sourceLine" id="cb31-8" title="8">  phi[i]=<span class="kw">rbeta</span>(<span class="dv">1</span>,<span class="dt">shape1=</span><span class="dv">2</span>,<span class="dt">shape2 =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb31-9" title="9">  y[i]=<span class="kw">rbinom</span>(<span class="dv">1</span>,<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">prob =</span> phi[i])</a>
<a class="sourceLine" id="cb31-10" title="10">}</a>
<a class="sourceLine" id="cb31-11" title="11"></a>
<a class="sourceLine" id="cb31-12" title="12"><span class="co"># we can use vector method</span></a>
<a class="sourceLine" id="cb31-13" title="13"></a>
<a class="sourceLine" id="cb31-14" title="14">phi=<span class="kw">rbeta</span>(m,<span class="dt">shape1 =</span> <span class="dv">2</span>,<span class="dt">shape2 =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb31-15" title="15">y=<span class="kw">rbinom</span>(m,<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">prob =</span> phi)</a>
<a class="sourceLine" id="cb31-16" title="16"><span class="kw">table</span>(y)<span class="op">/</span>m</a></code></pre></div>
<pre><code>## y
##     0     1     2     3     4     5     6     7     8     9    10 
## 0.038 0.064 0.100 0.110 0.124 0.112 0.131 0.117 0.093 0.069 0.042</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co"># The marginal distribution of y</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">plot</span>(<span class="kw">table</span>(y)<span class="op">/</span>m)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="co"># Another way to plot </span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="kw">plot</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(y)), <span class="dt">ylab=</span><span class="st">&quot;P(y)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Marginal distribution of y&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co"># the marginal expected value of y</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="kw">mean</span>(y)</a></code></pre></div>
<pre><code>## [1] 5.04</code></pre>

</div>
</div>
<div id="markov-chains" class="section level2">
<h2><span class="header-section-number">2.3</span> Markov chains</h2>
<div id="definition" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Definition</h3>
<p>A sequence of random variable <span class="math inline">\(X_1, X_2,...,X_n\)</span>, with <span class="math inline">\(1, 2, ...,3\)</span> indicating the successitve points in time. Thus, based on the chain rule, we can write the following:</p>
<p><span class="math display">\[p(X_1,X_2,...,X_n)=p(X_1)p(X_2|X_1)p(X_3|X_2,X_1)...p(X_n|X_{n-1},X_{n-2},...,X_2,X_1)\]</span></p>
<p>For Markov chains, it puts an assumption, called Markov assumption: The random variable at the next time step only depends on the current variable. Mathematically,</p>
<p><span class="math display">\[p(X_{t+1}|X_t,X_{t-1},...,X_2,X_1)=p(X_{t+1}|X_t)\]</span></p>
<p>where,</p>
<p><span class="math display">\[t=2, ...n\]</span></p>
<p>Thus, we can write the expression above as follows.</p>
<p><span class="math display">\[p(X_1,X_2,...,X_n)=p(X_1)p(X_2|X_1)p(X_3|X_2)P(X_4|X_3)...p(X_n|X_{n-1})\]</span></p>
</div>
<div id="discrete-example" class="section level3">
<h3><span class="header-section-number">2.3.2</span> Discrete example</h3>
<p>Suppose that you flip a coin. You have a set of number {1,2,3,4,5}. If it is head, you increase 1 in the next number (for instance, if you are 2 now, you will be get 3 in the next). In contrast, if it is tail, you will decrease the number (e.g., 2 is now and 1 is next). If is is 5, increase 1 will lead to 1. Logically, 1 and then it is reduced by 1, leading to 5.</p>
</div>
<div id="continuous-example" class="section level3">
<h3><span class="header-section-number">2.3.3</span> Continuous example</h3>
<p><span class="math display">\[p(X_{t+1}| X_t=x_t)=N(x_t,1)\]</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb37-2" title="2">n=<span class="dv">100</span></a>
<a class="sourceLine" id="cb37-3" title="3">x=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb37-4" title="4"></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb37-6" title="6">{x[i]=<span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dt">mean=</span>x[i<span class="dv">-1</span>],<span class="dv">1</span>)}</a>
<a class="sourceLine" id="cb37-7" title="7"></a>
<a class="sourceLine" id="cb37-8" title="8"><span class="kw">plot.ts</span>(x)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="discrete-example-and-transition-matrix" class="section level3">
<h3><span class="header-section-number">2.3.4</span> Discrete example and transition matrix</h3>
<p>For the discrete example above, we can write the following transition matrix. We know that <span class="math inline">\(p(X_{t+1}=5 | X_t=4)\)</span> can be found in the 4th row, 5th column, namely 0.5.</p>
<p><span class="math display">\[Q=\begin{bmatrix} 0 &amp; 0.5 &amp; 0 &amp; 0 &amp; 0.5 \\ 0.5 &amp; 0 &amp; 0.5 &amp; 0 &amp; 0\\ 0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; 0 \\ 0&amp; 0 &amp; 0.5&amp; 0&amp; 0.5\\ 0.5 &amp; 0&amp; 0 &amp;0.5 &amp; 0 \end{bmatrix}\]</span></p>
<p>The transition matrix is especially useful when there are mutiple steps in the chain. such as <span class="math inline">\(p(X_{t+1}=5| X_t=4)\)</span>. It can be calculated as <span class="math inline">\(\sum_{k=1}^{5} p(X_{t+2}=3|X_{t+1}=k) \cdot p(X_{t+1}=k |X_t=1)\)</span>. We can use R code the impletement this.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">Q =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb38-2" title="2">             <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>,</a>
<a class="sourceLine" id="cb38-3" title="3">             <span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>,</a>
<a class="sourceLine" id="cb38-4" title="4">             <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb38-5" title="5">             <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>), </a>
<a class="sourceLine" id="cb38-6" title="6">           <span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb38-7" title="7"></a>
<a class="sourceLine" id="cb38-8" title="8">(jj&lt;-Q <span class="op">%*%</span><span class="st"> </span>Q)</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,] 0.50 0.00 0.25 0.25 0.00
## [2,] 0.00 0.50 0.00 0.25 0.25
## [3,] 0.25 0.00 0.50 0.00 0.25
## [4,] 0.25 0.25 0.00 0.50 0.00
## [5,] 0.00 0.25 0.25 0.00 0.50</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">jj[<span class="dv">1</span>,<span class="dv">3</span>]</a></code></pre></div>
<pre><code>## [1] 0.25</code></pre>
</div>
<div id="stationary-distribution" class="section level3">
<h3><span class="header-section-number">2.3.5</span> Stationary distribution</h3>
<p><strong>Discrete Cases</strong>_</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">Q5 =<span class="st"> </span>Q <span class="op">%*%</span><span class="st"> </span>Q <span class="op">%*%</span><span class="st"> </span>Q <span class="op">%*%</span><span class="st"> </span>Q <span class="op">%*%</span><span class="st"> </span>Q <span class="co"># h=5 steps in the future</span></a>
<a class="sourceLine" id="cb42-2" title="2"></a>
<a class="sourceLine" id="cb42-3" title="3">Q5</a></code></pre></div>
<pre><code>##         [,1]    [,2]    [,3]    [,4]    [,5]
## [1,] 0.06250 0.31250 0.15625 0.15625 0.31250
## [2,] 0.31250 0.06250 0.31250 0.15625 0.15625
## [3,] 0.15625 0.31250 0.06250 0.31250 0.15625
## [4,] 0.15625 0.15625 0.31250 0.06250 0.31250
## [5,] 0.31250 0.15625 0.15625 0.31250 0.06250</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">round</span>(Q5, <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##       [,1]  [,2]  [,3]  [,4]  [,5]
## [1,] 0.062 0.312 0.156 0.156 0.312
## [2,] 0.312 0.062 0.312 0.156 0.156
## [3,] 0.156 0.312 0.062 0.312 0.156
## [4,] 0.156 0.156 0.312 0.062 0.312
## [5,] 0.312 0.156 0.156 0.312 0.062</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">Q30 =<span class="st"> </span>Q</a>
<a class="sourceLine" id="cb46-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">30</span>) {</a>
<a class="sourceLine" id="cb46-3" title="3">  Q30 =<span class="st"> </span>Q30 <span class="op">%*%</span><span class="st"> </span>Q</a>
<a class="sourceLine" id="cb46-4" title="4">}</a>
<a class="sourceLine" id="cb46-5" title="5"><span class="kw">round</span>(Q30, <span class="dv">3</span>) <span class="co"># h=30 steps in the future</span></a></code></pre></div>
<pre><code>##       [,1]  [,2]  [,3]  [,4]  [,5]
## [1,] 0.201 0.199 0.200 0.200 0.199
## [2,] 0.199 0.201 0.199 0.200 0.200
## [3,] 0.200 0.199 0.201 0.199 0.200
## [4,] 0.200 0.200 0.199 0.201 0.199
## [5,] 0.199 0.200 0.200 0.199 0.201</code></pre>
<p>Thus, as we can see, as the time gap gets bigger, the transition distributions appear to converge.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">Q =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb48-2" title="2">             <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>,</a>
<a class="sourceLine" id="cb48-3" title="3">             <span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>,</a>
<a class="sourceLine" id="cb48-4" title="4">             <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>,</a>
<a class="sourceLine" id="cb48-5" title="5">             <span class="fl">0.5</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span>, <span class="fl">0.5</span>, <span class="fl">0.0</span>), </a>
<a class="sourceLine" id="cb48-6" title="6">           <span class="dt">nrow=</span><span class="dv">5</span>, <span class="dt">byrow=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb48-7" title="7">Q</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]  0.0  0.5  0.0  0.0  0.5
## [2,]  0.5  0.0  0.5  0.0  0.0
## [3,]  0.0  0.5  0.0  0.5  0.0
## [4,]  0.0  0.0  0.5  0.0  0.5
## [5,]  0.5  0.0  0.0  0.5  0.0</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>) <span class="op">%*%</span><span class="st"> </span>Q</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]  0.2  0.2  0.2  0.2  0.2</code></pre>
<p>The definition of stationary distribution of a chain:</p>
<p>The initial state distribution for which performing a transition will not change the probability of ending up in any given state.</p>
<p>For a Markov chain after many iterations, the samples can be used as a Monte Carlo sample from the stationary distribution. Thus, we can use Markov chains for Bayesian inference. In order to simulate from a complicated posterior distribution, we will set up and run a Markov chain whose stationary distribution is the posterior distribution. (Note that: stationary distribution doesn’t always exist for any given Markov chain)</p>
<p><strong>Continuous Cases</strong>_</p>
<p>As we can see, the example shown earlier does not reach a stationary distribution. But, we can modify it to make it happen.</p>
<p><span class="math display">\[p(X_{t+1}|X_t=x_t)=N(\phi x_t,1), -1&lt;\phi&lt;1\]</span></p>
<p>It will reach a stationary distribution as long as <span class="math inline">\(-1&lt;\phi&lt;1\)</span>.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">n =<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb52-2" title="2">x =<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb52-3" title="3">phi =<span class="st"> </span><span class="fl">-0.5</span></a>
<a class="sourceLine" id="cb52-4" title="4"></a>
<a class="sourceLine" id="cb52-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb52-6" title="6">  x[i] =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean=</span>phi<span class="op">*</span>x[i<span class="dv">-1</span>], <span class="dt">sd=</span><span class="fl">1.0</span>)</a>
<a class="sourceLine" id="cb52-7" title="7">}</a>
<a class="sourceLine" id="cb52-8" title="8"></a>
<a class="sourceLine" id="cb52-9" title="9"><span class="kw">plot.ts</span>(x)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">hist</span>(x, <span class="dt">freq=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb53-2" title="2"><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="fl">0.0</span>, <span class="dt">sd=</span><span class="kw">sqrt</span>(<span class="fl">1.0</span><span class="op">/</span>(<span class="fl">1.0</span><span class="op">-</span>phi<span class="op">^</span><span class="dv">2</span>))), <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb53-3" title="3"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend=</span><span class="st">&quot;theoretical stationary</span><span class="ch">\n</span><span class="st">distribution&quot;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>, <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-15-2.png" width="672" /></p>
<p>It will reach the stationary distribution of <span class="math inline">\(N(0, \frac{1}{1-\phi^2})\)</span></p>

</div>
</div>
<div id="metropolis-hastings" class="section level2">
<h2><span class="header-section-number">2.4</span> Metropolis-Hastings</h2>
<div id="procedure" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Procedure</h3>
<ol style="list-style-type: decimal">
<li><p>Select initial value <span class="math inline">\(\theta_0\)</span></p></li>
<li><p>For <span class="math inline">\(i=1,..., m\)</span>, repeat:</p></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Draw candidate <span class="math inline">\(\theta^* \sim q(\theta^*|\theta_{i-1})\)</span></p></li>
<li><p><span class="math inline">\(\alpha=\frac{g(\theta^*)/q(\theta^*|\theta_{i-1})}{g(\theta_{i-1})/q(\theta_{i-1}|\theta^*)}=\frac{g(\theta^*)q(\theta_{i-1}|\theta^*)}{g(\theta_{i-1})q(\theta^*|\theta_{i-1})}\)</span></p></li>
<li><p><span class="math inline">\(\alpha \geq 1\)</span> accept <span class="math inline">\(\theta^*\)</span> and set <span class="math inline">\(\theta_i \leftarrow \theta^*\)</span></p></li>
</ol>
<p><span class="math inline">\(0&lt;\alpha &lt; 1\)</span> accept <span class="math inline">\(\theta^*\)</span> and set <span class="math inline">\(\theta_i \leftarrow \theta^*\)</span> with probablity <span class="math inline">\(\alpha\)</span></p>
</div>
<div id="demonstration" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Demonstration</h3>
<p>Prior <span class="math inline">\(P(loaded)=0.6\)</span></p>
<p><span class="math display">\[\begin{aligned} f(\theta | X) &amp;= \frac{f(x|\theta) f(\theta)}{\sum_{\theta} f(x|\theta)f(\theta)} \\ &amp;=\frac{\binom{5}{x} [(\frac{1}{2})^5 \times 0.4 \times I_{\{\theta=fair \}}+ (0.7)^x(0.3)^{5-x} \times 0.6 \times I_{\{\theta=loaded \}}]}{\binom{5}{x} [(\frac{1}{2})^5 \times 0.4 + (0.7)^x(0.3)^{5-x} \times 0.6]}  \end{aligned}\]</span></p>
<p><span class="math display">\[\begin{aligned} f(\theta |X=2) &amp;=\frac{0.0125 I_{\{\theta=fair \}}+0.0079 I_{\{\theta=loaded \}} }{0.0125+0.0079} \\ &amp;= 0.612 I_{\{\theta=fair \}} + 0.388 I_{\{\theta=loaded \}} \end{aligned}\]</span>
Thus, we can say that:</p>
<p><span class="math display">\[P(\theta=loaded | X=2)=0.388\]</span></p>
<ol style="list-style-type: decimal">
<li><p>Start at either <span class="math inline">\(\theta_0=fair\)</span> or <span class="math inline">\(\theta_0=loaded\)</span></p></li>
<li><p>For <span class="math inline">\(i=1, ...m\)</span></p></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Propose candidate <span class="math inline">\(\theta^*\)</span> to be the other state such as <span class="math inline">\(\theta_{i-1}\)</span></p></li>
<li></li>
</ol>
<p><span class="math display">\[\alpha=\frac{g(\theta^*)/q(\theta^*|\theta_{i-1})}{g(\theta_{i-1})/q(\theta_{i-1}|\theta^*)}=\frac{f(x=2|\theta^*)/1}{f(x=2|\theta_{i-1})/1}\]</span></p>
<p>If <span class="math inline">\(\theta^*=loaded, \alpha=\frac{0.0794}{0.0125}=0.635\)</span>
If <span class="math inline">\(\theta^*=fair, \alpha=\frac{0.0125}{0.0794}=1.574\)</span></p>
<ol start="3" style="list-style-type: lower-alpha">
<li>if <span class="math inline">\(\theta^*=fair, \alpha&gt;1\)</span>, accept <span class="math inline">\(\theta^*\)</span> set <span class="math inline">\(\theta_i=fair\)</span></li>
</ol>
<p>if <span class="math inline">\(\theta^*=loaded, \alpha&gt;0.635\)</span>, accept <span class="math inline">\(\theta^*\)</span> set <span class="math inline">\(\theta_i=loaded\)</span> w.p. 0.635.</p>
<p>Thus, we can get the following transition matrix:</p>
<p><span class="math display">\[Q=\begin{bmatrix} 0.365 &amp; 0.635  \\ 1 &amp; 0  \end{bmatrix}\]</span></p>
<p>This means that:</p>
<ol style="list-style-type: decimal">
<li><p>When <span class="math inline">\(\theta_{i-1}\)</span> is fair, <span class="math inline">\(\theta_{i}\)</span> is also fair, the <span class="math inline">\(P=0.365\)</span>.</p></li>
<li><p>When <span class="math inline">\(\theta_{i-1}\)</span> is fair, <span class="math inline">\(\theta_{i}\)</span> is loaded, the <span class="math inline">\(P=0.635\)</span>.</p></li>
<li><p>When <span class="math inline">\(\theta_{i-1}\)</span> is loaded, <span class="math inline">\(\theta_{i}\)</span> is fair, the <span class="math inline">\(P=1\)</span>.</p></li>
<li><p>When <span class="math inline">\(\theta_{i-1}\)</span> is loaded, <span class="math inline">\(\theta_{i}\)</span> is loaded, the <span class="math inline">\(P=0\)</span>.</p></li>
</ol>
<p>Thus,</p>
<p><span class="math display">\[\pi = [0.612, 0.388]\]</span></p>
<p><span class="math display">\[[0.612, 0.388]\begin{bmatrix} 0.365 &amp; 0.635  \\ 1 &amp; 0  \end{bmatrix}=[0.612, 0.388]\]</span></p>

</div>
<div id="r-code" class="section level3">
<h3><span class="header-section-number">2.4.3</span> R code</h3>
<p>The data are the percent change in total personnel for n=10 companies (1.2,1.4,-0.5,0.3,0.9,2.3,1.0,0.1,1.3,1.9). We assume such changes follow a normal distribution with known variance (but mean is unknown). For the mean (i.e., <span class="math inline">\(\mu\)</span>), we assume it follows a t distribution (i.e., the prior for the <span class="math inline">\(\mu\)</span> is t-distribution).Since t-distribution prior is not conjugate to a normal distribution, the posterior distribution is not in a standard form that we can easily sample. Thus, we need to set up a Markov chain whose stationary distribution is the posterior distribution.</p>
<p><span class="math display">\[p(\mu|y_1,...,y_n) \propto \frac{exp[n(\bar{y}\mu-\mu^2/2)]}{1+\mu^2}\]</span></p>
<p><span class="math display">\[log(g(\mu))=n(\bar{y}\mu-\mu^2/2)-log(1+\mu^2)\]</span></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">lg=<span class="cf">function</span>(mu, n, ybar)</a>
<a class="sourceLine" id="cb54-2" title="2">{ mu2=mu<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb54-3" title="3">  n<span class="op">*</span>(ybar<span class="op">*</span>mu<span class="op">-</span>mu2<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>mu2)}</a>
<a class="sourceLine" id="cb54-4" title="4"></a>
<a class="sourceLine" id="cb54-5" title="5">mu_now=<span class="dv">10</span></a>
<a class="sourceLine" id="cb54-6" title="6">cand_sd=<span class="dv">5</span></a>
<a class="sourceLine" id="cb54-7" title="7">y=<span class="kw">c</span>(<span class="fl">1.2</span>,<span class="fl">1.4</span>,<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="fl">0.9</span>,<span class="fl">2.3</span>,<span class="fl">1.0</span>,<span class="fl">0.1</span>,<span class="fl">1.3</span>,<span class="fl">1.9</span>)</a>
<a class="sourceLine" id="cb54-8" title="8">ybar=<span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb54-9" title="9">m=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb54-10" title="10">n=<span class="kw">length</span>(y)</a>
<a class="sourceLine" id="cb54-11" title="11">mu_storage&lt;-<span class="kw">c</span>()</a>
<a class="sourceLine" id="cb54-12" title="12">mu_storage&lt;-<span class="kw">c</span>(mu_storage,mu_now)</a>
<a class="sourceLine" id="cb54-13" title="13">acceptance_count=<span class="dv">0</span></a>
<a class="sourceLine" id="cb54-14" title="14"></a>
<a class="sourceLine" id="cb54-15" title="15">mh&lt;-<span class="cf">function</span>(mu_now,type_MH,cand_sd)</a>
<a class="sourceLine" id="cb54-16" title="16">{</a>
<a class="sourceLine" id="cb54-17" title="17">  </a>
<a class="sourceLine" id="cb54-18" title="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m)</a>
<a class="sourceLine" id="cb54-19" title="19">{</a>
<a class="sourceLine" id="cb54-20" title="20">  <span class="cf">if</span> (type_MH<span class="op">==</span><span class="st">&quot;randomwalk&quot;</span>)  <span class="co"># random walk, as mean is updated with mu_now</span></a>
<a class="sourceLine" id="cb54-21" title="21">  {</a>
<a class="sourceLine" id="cb54-22" title="22">  mu_cand =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">1</span>, <span class="dt">mean=</span>mu_now, <span class="dt">sd=</span>cand_sd)</a>
<a class="sourceLine" id="cb54-23" title="23">  }</a>
<a class="sourceLine" id="cb54-24" title="24">  <span class="cf">else</span></a>
<a class="sourceLine" id="cb54-25" title="25">  {</a>
<a class="sourceLine" id="cb54-26" title="26">    <span class="cf">if</span>(type_MH<span class="op">==</span><span class="st">&quot;independent&quot;</span>)  <span class="co"># independent, as mean is fixed</span></a>
<a class="sourceLine" id="cb54-27" title="27">    {mu_cand =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">1</span>, <span class="dt">mean=</span><span class="dv">3</span>, <span class="dt">sd=</span>cand_sd)}</a>
<a class="sourceLine" id="cb54-28" title="28">    <span class="cf">else</span></a>
<a class="sourceLine" id="cb54-29" title="29">    {<span class="kw">print</span>(<span class="st">&quot;woring type of MH&quot;</span>)</a>
<a class="sourceLine" id="cb54-30" title="30">     <span class="cf">break</span></a>
<a class="sourceLine" id="cb54-31" title="31">    }</a>
<a class="sourceLine" id="cb54-32" title="32">  }</a>
<a class="sourceLine" id="cb54-33" title="33">  </a>
<a class="sourceLine" id="cb54-34" title="34">  lg_alpha=<span class="kw">lg</span>(mu_cand,<span class="dt">n=</span>n,<span class="dt">ybar =</span> ybar)<span class="op">-</span><span class="kw">lg</span>(mu_now,<span class="dt">n=</span>n,<span class="dt">ybar=</span>ybar)</a>
<a class="sourceLine" id="cb54-35" title="35">  alpha=<span class="kw">exp</span>(lg_alpha)</a>
<a class="sourceLine" id="cb54-36" title="36">  <span class="cf">if</span>(alpha<span class="op">&gt;</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb54-37" title="37">    {mu_now=mu_cand</a>
<a class="sourceLine" id="cb54-38" title="38">    mu_storage&lt;-<span class="kw">c</span>(mu_storage,mu_cand)</a>
<a class="sourceLine" id="cb54-39" title="39">    acceptance_count=acceptance_count<span class="op">+</span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb54-40" title="40">  <span class="cf">else</span></a>
<a class="sourceLine" id="cb54-41" title="41">    {random_p=<span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb54-42" title="42">    <span class="cf">if</span>(alpha<span class="op">&gt;</span>random_p)</a>
<a class="sourceLine" id="cb54-43" title="43">      {mu_now=mu_cand</a>
<a class="sourceLine" id="cb54-44" title="44">      acceptance_count=acceptance_count<span class="op">+</span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb54-45" title="45">    <span class="cf">else</span></a>
<a class="sourceLine" id="cb54-46" title="46">      {mu_now=mu_now}</a>
<a class="sourceLine" id="cb54-47" title="47">    }</a>
<a class="sourceLine" id="cb54-48" title="48">}</a>
<a class="sourceLine" id="cb54-49" title="49"><span class="co">#return the following</span></a>
<a class="sourceLine" id="cb54-50" title="50"><span class="kw">list</span>(<span class="dt">mu=</span>mu_storage,<span class="dt">accpt=</span>acceptance_count<span class="op">/</span>m)</a>
<a class="sourceLine" id="cb54-51" title="51">}</a>
<a class="sourceLine" id="cb54-52" title="52"></a>
<a class="sourceLine" id="cb54-53" title="53">tt_<span class="dv">0</span>&lt;-<span class="kw">mh</span>(<span class="dt">mu_now=</span><span class="dv">5</span>,<span class="dt">type_MH=</span><span class="st">&quot;randomwalk&quot;</span>,<span class="dt">cand_sd=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb54-54" title="54"><span class="kw">plot.ts</span>(tt_<span class="dv">0</span><span class="op">$</span>mu)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1">tt_<span class="dv">0</span><span class="op">$</span>accpt</a></code></pre></div>
<pre><code>## [1] 0.039</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1">tt_<span class="dv">1</span>&lt;-<span class="kw">mh</span>(<span class="dt">mu_now=</span><span class="dv">5</span>,<span class="dt">type_MH=</span><span class="st">&quot;randomwalk&quot;</span>,<span class="dt">cand_sd=</span><span class="fl">0.005</span>)</a>
<a class="sourceLine" id="cb57-2" title="2"><span class="kw">plot.ts</span>(tt_<span class="dv">1</span><span class="op">$</span>mu)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-16-2.png" width="672" /></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">tt_<span class="dv">1</span><span class="op">$</span>accpt</a></code></pre></div>
<pre><code>## [1] 0.931</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">tt_<span class="dv">2</span>&lt;-<span class="kw">mh</span>(<span class="dt">mu_now=</span><span class="dv">5</span>,<span class="dt">type_MH=</span><span class="st">&quot;randomwalk&quot;</span>,<span class="dt">cand_sd=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">plot.ts</span>(tt_<span class="dv">2</span><span class="op">$</span>mu)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-16-3.png" width="672" /></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">tt_<span class="dv">2</span><span class="op">$</span>accpt</a></code></pre></div>
<pre><code>## [1] 0.587</code></pre>
<p>As we can see, when the variance is big, the acceptance rate is low. When the variance is low, in conrast, the acceptance rate is high. Note that, changing the mean does not change the acceptance rate too much. In the following, I plotted the prior, posteior, and the sample(i.e., <span class="math inline">\(y\)</span>).</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1">mu_keep&lt;-tt_<span class="dv">2</span><span class="op">$</span>mu[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)]</a>
<a class="sourceLine" id="cb63-2" title="2"><span class="kw">plot</span>(<span class="kw">density</span>(mu_keep),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">6</span>))</a>
<a class="sourceLine" id="cb63-3" title="3"><span class="kw">curve</span>(<span class="kw">dt</span>(x,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">lty=</span><span class="dv">2</span>,<span class="dt">add =</span> <span class="ot">TRUE</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb63-4" title="4"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&quot;Prior t-distribution pdf&quot;</span>, <span class="st">&quot;Posterior pdf&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;black&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb63-5" title="5"><span class="kw">points</span>(ybar,<span class="dv">0</span>,<span class="dt">pch=</span><span class="dv">20</span>)</a>
<a class="sourceLine" id="cb63-6" title="6"><span class="kw">legend</span>(<span class="dv">1</span>,<span class="dv">1</span>, <span class="dt">legend=</span><span class="st">&quot;Black dot is the sample mean (y_hat)&quot;</span>,<span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>In the following, I show the situation that the proposal distribution is not random walk, but rather independent. That is, the mean for the normal distribution is fixed. Refer to the procedure of MH, there is a setence of:</p>
<center>
<p><strong>Draw candidate <span class="math inline">\(\theta^* \sim q(\theta^*|\theta_{i-1})\)</span></strong></p>
</center>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">tt_<span class="dv">3</span>&lt;-<span class="kw">mh</span>(<span class="dt">mu_now=</span><span class="dv">5</span>,<span class="dt">type_MH=</span><span class="st">&quot;independent&quot;</span>,<span class="dt">cand_sd=</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb64-2" title="2"><span class="kw">plot.ts</span>(tt_<span class="dv">3</span><span class="op">$</span>mu)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1">tt_<span class="dv">3</span><span class="op">$</span>accpt</a></code></pre></div>
<pre><code>## [1] 0.016</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="co">#tt_4&lt;-mh(mu_now=5,type_MH=&quot;hello&quot;,cand_sd=0.5)</span></a>
<a class="sourceLine" id="cb67-2" title="2"><span class="co">#tt_4</span></a></code></pre></div>

</div>
</div>
<div id="gibbs-sampling" class="section level2">
<h2><span class="header-section-number">2.5</span> Gibbs sampling</h2>
<div id="basic-idea" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Basic idea</h3>
<p><span class="math display">\[p(\theta, \phi|y) \propto g(\theta, \phi)\]</span></p>
<p><span class="math display">\[p(\theta, \phi|y) = p(\phi |y)p(\theta| \phi,y)\]</span></p>
<p><strong>Notes</strong></p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(p(\theta| \phi,y)\)</span> is called the full conditional for theta.</p></li>
<li><p>We can update one parameter at a time.</p></li>
</ol>
<p><span class="math display">\[p(\theta| \phi,y) \propto p(\theta, \phi|y) \propto g(\theta, \phi)\]</span></p>
<p><span class="math display">\[p(\phi| \theta,y) \propto p(\theta, \phi|y) \propto g(\theta, \phi)\]</span></p>
</div>
<div id="procedure-1" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Procedure</h3>
<ol style="list-style-type: decimal">
<li><p>Initialize <span class="math inline">\(\theta_0\)</span>, <span class="math inline">\(\phi_0\)</span>.</p></li>
<li><p>For <span class="math inline">\(i=1,..., m\)</span>, repeat:</p>
<ol style="list-style-type: lower-alpha">
<li>Using <span class="math inline">\(\phi_{i-1}\)</span>, draw <span class="math inline">\(\theta_i \sim p(\theta|\phi_{i-1},y)\)</span></li>
<li>Using <span class="math inline">\(\theta_i\)</span>, draw <span class="math inline">\(\phi_i \sim p(\phi|\theta_i,y)\)</span></li>
</ol></li>
</ol>
</div>
<div id="example" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Example</h3>
<p><span class="math display">\[y_i|\mu, \sigma^2 \sim N(\mu, \sigma^2),i = 1, ...,n\]</span></p>
<p><span class="math display">\[\mu \sim N(\mu_0,\sigma_0^2)\]</span></p>
<p><span class="math display">\[\sigma^2 \sim IG(v_0,\beta_0)\]</span></p>
<p><span class="math display">\[\begin{aligned} p(\mu, \sigma^2) &amp;\propto p(y1,...,y_n| \mu, \sigma^2)p(\mu)p(\sigma^2) \\ &amp;=\prod_{i=1}^n[N(y_i|\mu,\sigma^2)]N(\mu|\mu_0,\sigma_0^2)IG(\sigma^2|v_0,\beta_0)\\ &amp;= \prod_{i=1}^n [\frac{1}{\sqrt{2\pi \sigma^2}} exp(-\frac{1}{2\sigma^2}(y_i-\mu)^2)] \cdot \frac{1}{\sqrt{2\pi \sigma_0^2}} exp(-\frac{1}{2\sigma_0^2}(\mu-\mu_0)^2) \\ &amp;\cdot \frac{\beta_0^{v_0}}{\Gamma(v_0)}(\sigma^2)^{-(v_0+1)}exp(-\frac{\beta_0}{\sigma^2}) \\ &amp;\propto (\sigma^2)^{-\frac{n}{2}}exp[-\frac{1}{2\sigma^2} \sum_{i=1}^n(y_i-\mu)^2] \cdot exp[-\frac{1}{2\sigma_0^2}(\mu-\mu_0)^2] \cdot (\sigma^2)^{-(v_0+1)}exp[-\frac{\beta_0}{\sigma^2}] \end{aligned}\]</span></p>
<p>The following the full conditoinal distribution:</p>
<p><span class="math display">\[p(\mu| \sigma^2, y_1,...,y_n) \propto p(\mu,\sigma^2,y_1,...,y_n)\]</span></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-1.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/41-Bayesian2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
